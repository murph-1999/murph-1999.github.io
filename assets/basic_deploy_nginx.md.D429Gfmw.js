import{_ as s,o as i,c as a,a8 as n}from"./chunks/framework.Q0X2mdF-.js";const c=JSON.parse('{"title":"nginx有哪些作用","description":"","frontmatter":{},"headers":[],"relativePath":"basic/deploy/nginx.md","filePath":"basic/deploy/nginx.md","lastUpdated":null}'),l={name:"basic/deploy/nginx.md"},t=n(`<h1 id="nginx有哪些作用" tabindex="-1">nginx有哪些作用 <a class="header-anchor" href="#nginx有哪些作用" aria-label="Permalink to &quot;nginx有哪些作用&quot;">​</a></h1><hr><h3 id="nginx-的核心作用及实践场景总结" tabindex="-1"><strong>Nginx 的核心作用及实践场景总结</strong> <a class="header-anchor" href="#nginx-的核心作用及实践场景总结" aria-label="Permalink to &quot;**Nginx 的核心作用及实践场景总结**&quot;">​</a></h3><p>Nginx 是一款高性能的 <strong>Web 服务器</strong> 和 <strong>反向代理服务器</strong>，同时支持负载均衡、缓存加速、安全防护等功能，广泛应用于现代 Web 架构中。以下是其核心作用及典型应用场景：</p><hr><h4 id="一、静态资源托管" tabindex="-1"><strong>一、静态资源托管</strong> <a class="header-anchor" href="#一、静态资源托管" aria-label="Permalink to &quot;**一、静态资源托管**&quot;">​</a></h4><ul><li><strong>作用</strong>：高效分发前端静态文件（HTML/CSS/JS/图片等）。</li><li><strong>优势</strong>： <ul><li>支持高并发（事件驱动模型），适合 CDN 边缘节点。</li><li>通过 <code>sendfile</code> 零拷贝技术提升文件传输效率。</li></ul></li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/html;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 启用缓存控制</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    expires </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Cache-Control </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;public, max-age=604800&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 处理静态资源</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ~*</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> \\.(js|css|png|jpg|gif|ico)$ </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    expires </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">365d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    access_log </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h4 id="二、反向代理-reverse-proxy" tabindex="-1"><strong>二、反向代理（Reverse Proxy）</strong> <a class="header-anchor" href="#二、反向代理-reverse-proxy" aria-label="Permalink to &quot;**二、反向代理（Reverse Proxy）**&quot;">​</a></h4><ul><li><strong>作用</strong>：隐藏后端服务（如 Node.js、Java 应用），转发客户端请求。</li><li><strong>场景</strong>： <ul><li>前端访问 <code>/api</code> 时代理到后端服务。</li><li>隐藏后端服务器 IP 和端口，提升安全性。</li></ul></li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api.example.com;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://backend-server:3000;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Host $host;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X-Real-IP $remote_addr;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X-Forwarded-For $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h4 id="三、负载均衡-load-balancing" tabindex="-1"><strong>三、负载均衡（Load Balancing）</strong> <a class="header-anchor" href="#三、负载均衡-load-balancing" aria-label="Permalink to &quot;**三、负载均衡（Load Balancing）**&quot;">​</a></h4><ul><li><strong>作用</strong>：将流量分发到多个后端服务器，提升可用性和扩展性。</li><li><strong>策略</strong>： <ul><li><strong>轮询（Round Robin）</strong>：默认方式，均匀分配请求。</li><li><strong>加权轮询（Weighted Round Robin）</strong>：按服务器性能分配权重。</li><li><strong>IP 哈希（IP Hash）</strong>：同一客户端 IP 固定访问某台服务器（适合会话保持）。</li></ul></li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">upstream</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> backend </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> backend1.example.com </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">weight</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 权重3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  server backend2.example.com;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> backend3.example.com backup;    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 备用服务器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://backend;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h4 id="四、ssl-tls-终止" tabindex="-1"><strong>四、SSL/TLS 终止</strong> <a class="header-anchor" href="#四、ssl-tls-终止" aria-label="Permalink to &quot;**四、SSL/TLS 终止**&quot;">​</a></h4><ul><li><strong>作用</strong>：处理 HTTPS 加密/解密，减轻后端服务器压力。</li><li><strong>场景</strong>：为网站启用 HTTPS，支持 HTTP/2。</li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ssl http2;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ssl_certificate </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/etc/nginx/ssl/example.com.crt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ssl_certificate_key </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/etc/nginx/ssl/example.com.key;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 安全优化（禁用旧协议，启用强加密套件）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ssl_protocols </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TLSv1.2 TLSv1.3;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ssl_ciphers </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ssl_prefer_server_ciphers </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h4 id="五、缓存加速" tabindex="-1"><strong>五、缓存加速</strong> <a class="header-anchor" href="#五、缓存加速" aria-label="Permalink to &quot;**五、缓存加速**&quot;">​</a></h4><ul><li><strong>作用</strong>：缓存动态内容或代理结果，减少后端请求压力。</li><li><strong>场景</strong>：缓存 API 响应、页面片段。</li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">proxy_cache_path </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/cache/nginx levels=1:2 keys_zone=my_cache:10m inactive=60m;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_cache </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">my_cache;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://backend;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_cache_valid </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 302</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 缓存200/302响应10分钟</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    proxy_cache_valid </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">404</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h4 id="六、访问控制与安全防护" tabindex="-1"><strong>六、访问控制与安全防护</strong> <a class="header-anchor" href="#六、访问控制与安全防护" aria-label="Permalink to &quot;**六、访问控制与安全防护**&quot;">​</a></h4><ul><li><strong>作用</strong>：限制访问权限，防止恶意请求。</li><li><strong>常用配置</strong>： <ul><li><strong>IP 黑白名单</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /admin </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  allow </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">192.168.1.0/24;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  deny </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><strong>速率限制（防 DDoS）</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">limit_req_zone </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$binary_remote_addr zone=mylimit:10m rate=10r/s;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  limit_req </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">zone=mylimit burst=20 nodelay;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><strong>防盗链</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ~*</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> \\.(jpg|png)$ </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  valid_referers </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">none blocked example.com;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($invalid_referer) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 403</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul></li></ul><hr><h4 id="七、gzip-压缩" tabindex="-1"><strong>七、Gzip 压缩</strong> <a class="header-anchor" href="#七、gzip-压缩" aria-label="Permalink to &quot;**七、Gzip 压缩**&quot;">​</a></h4><ul><li><strong>作用</strong>：压缩文本资源（HTML/CSS/JS），减少传输体积。</li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">gzip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">gzip_types </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">text/plain text/css application/json application/javascript text/xml;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">gzip_min_length </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">gzip_comp_level </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></li></ul><hr><h4 id="八、url-重写与重定向" tabindex="-1"><strong>八、URL 重写与重定向</strong> <a class="header-anchor" href="#八、url-重写与重定向" aria-label="Permalink to &quot;**八、URL 重写与重定向**&quot;">​</a></h4><ul><li><strong>作用</strong>：优化 URL 结构，支持 SEO 或路由跳转。</li><li><strong>场景</strong>： <ul><li>强制 HTTPS 跳转。</li><li>前端路由（如 Vue/React 的 History 模式）。</li></ul></li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 强制跳转 HTTPS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 301</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> https://$host$request_uri;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ssl;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 支持前端路由</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ /index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h4 id="九、websocket-代理" tabindex="-1"><strong>九、WebSocket 代理</strong> <a class="header-anchor" href="#九、websocket-代理" aria-label="Permalink to &quot;**九、WebSocket 代理**&quot;">​</a></h4><ul><li><strong>作用</strong>：代理 WebSocket 请求，支持实时通信。</li><li><strong>配置示例</strong>：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /ws </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://websocket-server;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  proxy_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Upgrade $http_upgrade;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Connection </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Upgrade&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><hr><h3 id="十、总结-nginx-在现代-web-架构中的角色" tabindex="-1"><strong>十、总结：Nginx 在现代 Web 架构中的角色</strong> <a class="header-anchor" href="#十、总结-nginx-在现代-web-架构中的角色" aria-label="Permalink to &quot;**十、总结：Nginx 在现代 Web 架构中的角色**&quot;">​</a></h3><ol><li><strong>性能优化</strong>：通过静态资源托管、缓存、压缩提升网站速度。</li><li><strong>安全加固</strong>：通过访问控制、SSL、限流抵御攻击。</li><li><strong>高可用性</strong>：通过负载均衡和反向代理保障服务稳定。</li><li><strong>灵活路由</strong>：支持 URL 重写、多域名管理。</li><li><strong>协议支持</strong>：无缝处理 HTTP/2、WebSocket 等现代协议。</li></ol><hr><p><strong>典型应用场景</strong>：</p><ul><li><strong>前端部署</strong>：托管构建后的静态文件，配置路由和缓存。</li><li><strong>微服务网关</strong>：反向代理多个后端服务，统一入口。</li><li><strong>全站加速</strong>：结合 CDN 和负载均衡应对高并发流量。</li></ul><h1 id="nginx支持的常用配置" tabindex="-1">nginx支持的常用配置 <a class="header-anchor" href="#nginx支持的常用配置" aria-label="Permalink to &quot;nginx支持的常用配置&quot;">​</a></h1><p>设置 HTTP 协议版本 HTTP/2 二进制协议：HTTP/2 使用二进制格式进行数据传输，相较于 HTTP/1.1 的文本格式，它更高效，数据解析更快速。 多路复用（Multiplexing）：HTTP/2 允许在同一个连接中并行传输多个请求和响应，而不需要等待一个请求完成再发送下一个。它通过“流”（stream）来实现这一点，有效地解决了 HTTP/1.x 的队头阻塞问题。 头部压缩（Header Compression）：HTTP/2 引入了 HPACK（HTTP Header Compression）算法，压缩 HTTP 请求和响应的头部，减少了每个请求所需传输的头部数据量，优化了性能。 2. 多路复用 HTTP/1.1：每个请求需要建立一个独立的 TCP 连接，或者使用持久连接，但即使使用持久连接，也不能在一个连接中并行处理多个请求（会遇到队头阻塞问题）。因此，如果有多个请求，浏览器通常会通过多个 TCP 连接来并行请求不同的资源（如图片、JS、CSS 文件等）。 HTTP/2：支持 多路复用，即多个请求和响应可以共享一个 TCP 连接进行并行处理，这大大减少了建立多个 TCP 连接的开销。浏览器可以通过一个连接同时处理多个请求，解决了 HTTP/1.1 中的队头阻塞问题。</p><p>为什么要设置http2呢 总结： HTTP/1.1 中，每个浏览器与每个域名的最大并发请求数通常是 6 个，但这个数字可以根据浏览器不同有所差异。 使用 多个 TCP 连接 可以在一定程度上增加并发请求数，但会带来额外的连接开销和潜在的网络性能问题。 对于更高效的并发请求管理，推荐使用 HTTP/2 协议，它通过 多路复用 使得在单个连接中可以同时处理多个请求，解决了 HTTP/1.1 中的并发问题和队头阻塞。</p><p>如何设置http2呢？它是默认开启多路复用的</p>`,41),p=[t];function h(e,k,r,g,d,o){return i(),a("div",{"data-pagefind-body":!0},p)}const y=s(l,[["render",h]]);export{c as __pageData,y as default};
